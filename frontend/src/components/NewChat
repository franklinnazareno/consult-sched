import { useState } from "react"
import { useAuthContext } from "../hooks/useAuthContext"
import AddIcon from '@mui/icons-material/Add';


const NewChat = () => {
    const { user } = useAuthContext()
    
    const [teachProfiles, setTeachProfiles] = useState('')
    const [assignedTeach, setAssignedTeach] = useState('')
    const [text, setText] = useState('')

    const [error, setError] = useState(null)

    // fetch list of Instructors on database
    useEffect(() => {
        const fetchTeachProfiles = async () => {
            const response = await fetch('/api/profile/teachers', {
                headers: {
                    'x-auth-token': `${user.token}`
                }
            })

            const json = await response.json()

            if (response.ok) {
                setTeachProfiles(json)
            }
        }
        
        if (user) { 
            fetchTeachProfiles()
        }
    }, [user])

    const handleSubmit = async (e) => {
        e.preventDefault()

        setError(null)

        const newChat = {
            text
        }

        const response = await fetch(`/api/appointments/${assignedTeach}`, {
            method: 'POST',
            body: JSON.stringify(newChat),
            headers: {
                'Content-Type': 'application/json',
                'x-auth-token': `${user.token}`
            }
        })

        const json = await response.json()

        //TODO: set error checking to receive multiple errors
        if (!response.ok) {
            setError(json.error)
        }
    };

    return (
        'Yes'
    )
}